<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title><%= bot.name %> ‚Äî Bot Trading</title>
  <link rel="stylesheet" href="/css/styles.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
      color: #e2e8f0;
      min-height: 100vh;
    }

    .vx_bot_page {
      min-height: 100vh;
      background: transparent;
      padding-bottom: 3rem;
    }

    .vx_bot_container {
      max-width: 1300px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    .vx_back {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      color: #3b82f6;
      text-decoration: none;
      font-weight: 700;
      font-size: 0.95rem;
      margin-bottom: 2rem;
      transition: all 0.3s ease;
    }

    .vx_back:hover {
      color: #60a5fa;
      transform: translateX(-5px);
    }

    .vx_header_section {
      background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
      border: 1px solid #334155;
      border-radius: 16px;
      padding: 2.5rem;
      margin-bottom: 2rem;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
    }

    .vx_bot_head {
      display: flex;
      gap: 2rem;
      align-items: flex-start;
      margin-bottom: 2rem;
    }

    .vx_bot_avatar {
      width: 100px;
      height: 100px;
      border-radius: 16px;
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      color: #ffffff;
      font-size: 2rem;
      box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
      flex-shrink: 0;
    }

    .vx_bot_info {
      flex: 1;
    }

    .vx_bot_title {
      font-size: clamp(1.5rem, 4vw, 2rem);
      font-weight: 800;
      margin: 0;
      color: #ffffff;
      margin-bottom: 0.5rem;
      letter-spacing: -0.02em;
    }

    .vx_bot_sub {
      color: #94a3b8;
      margin: 0.5rem 0;
      font-weight: 500;
      font-size: 1rem;
    }

    .vx_bot_meta {
      display: flex;
      gap: 1rem;
      margin-top: 1.2rem;
      flex-wrap: wrap;
    }

    .vx_chip {
      background: rgba(59, 130, 246, 0.15);
      border: 1px solid rgba(59, 130, 246, 0.3);
      padding: 0.7rem 1rem;
      border-radius: 10px;
      color: #cbd5e1;
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .vx_chip strong {
      color: #60a5fa;
    }

    .vx_sections {
      display: grid;
      grid-template-columns: 1fr 380px;
      gap: 2rem;
      margin-top: 0;
    }

    .vx_left {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .vx_performance_grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .vx_perf_card {
      background: linear-gradient(145deg, rgba(30, 41, 59, 0.8), rgba(15, 23, 42, 0.6));
      border: 1px solid #334155;
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
      transition: all 0.3s ease;
    }

    .vx_perf_card:hover {
      border-color: #3b82f6;
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
    }

    .vx_perf_value {
      font-size: 1.8rem;
      font-weight: 800;
      color: #60a5fa;
      margin: 0.5rem 0;
    }

    .vx_perf_label {
      font-size: 0.85rem;
      color: #94a3b8;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .vx_strategy_section {
      background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
      border: 1px solid #334155;
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .vx_section_title {
      font-size: 1.3rem;
      font-weight: 800;
      color: #ffffff;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .vx_section_icon {
      font-size: 1.5rem;
    }

    .vx_strategy_grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .vx_strategy_card {
      background: rgba(30, 41, 59, 0.6);
      border: 1px solid #334155;
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.3s ease;
    }

    .vx_strategy_card:hover {
      border-color: #3b82f6;
      background: rgba(59, 130, 246, 0.1);
    }

    .vx_strategy_card_label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      font-weight: 600;
      color: #cbd5e1;
      margin-bottom: 0.75rem;
    }

    .vx_strategy_card_value {
      font-size: 1.1rem;
      font-weight: 700;
      color: #ffffff;
    }

    .vx_description_box {
      background: rgba(30, 41, 59, 0.4);
      border: 1px solid #334155;
      border-radius: 12px;
      padding: 1.5rem;
    }

    .vx_description_title {
      font-size: 0.95rem;
      font-weight: 700;
      color: #cbd5e1;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .vx_description_text {
      font-size: 0.95rem;
      color: #cbd5e1;
      line-height: 1.7;
    }

    .vx_right {
      background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
      border: 1px solid #334155;
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      height: fit-content;
      position: sticky;
      top: 2rem;
    }

    .vx_investment_section {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .vx_investment_header {
      font-size: 1.2rem;
      font-weight: 800;
      color: #ffffff;
      margin-bottom: 0.5rem;
    }

    .vx_investment_grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .vx_stat_box {
      background: rgba(30, 41, 59, 0.6);
      border: 1px solid #334155;
      border-radius: 10px;
      padding: 1rem;
    }

    .vx_label {
      color: #94a3b8;
      font-weight: 600;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
      display: block;
    }

    .vx_stat {
      font-size: 1.5rem;
      font-weight: 800;
      color: #60a5fa;
    }

    .vx_expected_roi_box {
      background: rgba(30, 41, 59, 0.6);
      border: 1px solid #334155;
      border-radius: 10px;
      padding: 1rem;
      grid-column: 1 / -1;
    }

    .vx_divider {
      height: 1px;
      background: #334155;
      margin: 1.5rem 0;
    }

    .vx_investment_amount_section {
      background: rgba(30, 41, 59, 0.4);
      border: 1px solid #334155;
      border-radius: 10px;
      padding: 1.5rem;
    }

    .vx_amount_label {
      display: block;
      color: #cbd5e1;
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 0.75rem;
    }

    .vx_control {
      display: flex;
      gap: 0.75rem;
      align-items: center;
    }

    .vx_input {
      flex: 1;
      padding: 0.9rem;
      border-radius: 8px;
      border: 1px solid #334155;
      background: rgba(15, 23, 42, 0.8);
      color: #e2e8f0;
      font-size: 0.95rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .vx_input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
      background: rgba(15, 23, 42, 0.9);
    }

    .vx_btn_primary {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      color: #ffffff;
      border: none;
      padding: 0.9rem 1.5rem;
      border-radius: 8px;
      font-weight: 800;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .vx_btn_primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
    }

    .vx_btn_primary:active {
      transform: translateY(0);
    }

    .vx_reinvest_section {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .vx_reinvest_label {
      color: #cbd5e1;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .vx_checkbox_group {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .vx_checkbox {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: #3b82f6;
    }

    .vx_reinvest_pct_group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .vx_reinvest_pct_input {
      width: 70px;
      padding: 0.6rem;
      border-radius: 6px;
      border: 1px solid #334155;
      background: rgba(15, 23, 42, 0.8);
      color: #e2e8f0;
      font-weight: 600;
    }

    .vx_risk_section {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 10px;
      padding: 1.5rem;
      margin-top: 1.5rem;
    }

    .vx_risk_title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 800;
      color: #fca5a5;
      margin-bottom: 0.75rem;
      font-size: 0.95rem;
    }

    .vx_risk_text {
      font-size: 0.85rem;
      color: #fca5a5;
      line-height: 1.6;
    }

    .vx_small {
      font-size: 0.85rem;
      color: #94a3b8;
    }

    .vx_helper_text {
      font-size: 0.8rem;
      color: #64748b;
      margin-top: 0.5rem;
    }

    @media (max-width: 1024px) {
      .vx_sections {
        grid-template-columns: 1fr;
      }

      .vx_right {
        position: static;
      }

      .vx_bot_head {
        gap: 1.5rem;
      }
    }

    @media (max-width: 768px) {
      .vx_bot_container {
        padding: 1rem 0.75rem;
      }

      .vx_header_section {
        padding: 1.5rem;
      }

      .vx_bot_head {
        flex-direction: column;
        align-items: center;
        text-align: center;
      }

      .vx_bot_avatar {
        width: 80px;
        height: 80px;
        font-size: 1.5rem;
      }

      .vx_bot_info {
        width: 100%;
      }

      .vx_performance_grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .vx_strategy_grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .vx_container {
        padding: 1rem 0.5rem;
      }

      .vx_header_section {
        padding: 1.2rem;
      }

      .vx_performance_grid {
        grid-template-columns: 1fr;
      }

      .vx_investment_grid {
        grid-template-columns: 1fr;
      }

      .vx_control {
        flex-direction: column;
      }

      .vx_btn_primary {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <%- include('../partials/user-nav.ejs', { user, page: '' }) %>
    <main class="dashboard-content vx_bot_page">
      <div class="vx_bot_container">
        <a class="vx_back" href="/user/ai-trading-bots">‚Üê Back to Bots</a>

        <div class="vx_header_section">
          <div class="vx_bot_head">
            <div class="vx_bot_avatar"><%= bot.name.split(' ').map(n=>n[0]).slice(0,2).join('') %></div>
            <div class="vx_bot_info">
              <h1 class="vx_bot_title"><%= bot.name %></h1>
              <div class="vx_bot_sub"><%= bot.title %></div>
              <div class="vx_bot_meta">
                <div class="vx_chip">
                  <span style="color:#10b981">‚óè</span>
                  Status: <strong><%= bot.status %></strong>
                </div>
                <div class="vx_chip">
                  <span>üìà</span>
                  Performance: <strong><%= bot.performance %>%</strong>
                </div>
                <div class="vx_chip">
                  <span>‚úì</span>
                  Success Rate: <strong><%= bot.successRate %></strong>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="vx_sections">
          <section class="vx_left">
            <div class="vx_performance_grid">
              <div class="vx_perf_card">
                <div class="vx_perf_label">Success Rate</div>
                <div class="vx_perf_value"><%= bot.successRate %></div>
              </div>
              <div class="vx_perf_card">
                <div class="vx_perf_label">Total Trades</div>
                <div class="vx_perf_value">0</div>
              </div>
              <div class="vx_perf_card">
                <div class="vx_perf_label">Total Profit</div>
                <div class="vx_perf_value">$0.00</div>
              </div>
              <div class="vx_perf_card">
                <div class="vx_perf_label">Expected Return</div>
                <div class="vx_perf_value"><%= bot.expectedROI %></div>
              </div>
            </div>

            <div class="vx_strategy_section">
              <h3 class="vx_section_title">
                <span class="vx_section_icon">‚öôÔ∏è</span>
                Trading Strategy
              </h3>

              <div class="vx_strategy_grid">
                <div class="vx_strategy_card">
                  <div class="vx_strategy_card_label">
                    <span>üéØ</span>
                    Strategy Type
                  </div>
                  <div class="vx_strategy_card_value"><%= bot.strategyType %></div>
                </div>
                <div class="vx_strategy_card">
                  <div class="vx_strategy_card_label">
                    <span>üîÑ</span>
                    Trading Frequency
                  </div>
                  <div class="vx_strategy_card_value"><%= bot.tradingFrequency %></div>
                </div>
              </div>

              <div class="vx_description_box">
                <div class="vx_description_title">
                  <span>üìù</span>
                  Description
                </div>
                <div class="vx_description_text"><%= bot.description %></div>
              </div>
            </div>

            <div class="vx_strategy_section">
              <h3 class="vx_section_title">
                <span class="vx_section_icon">‚ö†Ô∏è</span>
                Risk Information
              </h3>
              <div class="vx_description_text">
                Trading involves substantial risk and may result in loss of capital. Past performance does not guarantee future results. Only invest what you can afford to lose. Bot trading is automated but not guaranteed to be profitable.
              </div>
            </div>
          </section>

          <aside class="vx_right">
            <div class="vx_investment_section">
              <div class="vx_investment_header">Investment Details</div>

              <div class="vx_investment_grid">
                <div class="vx_stat_box">
                  <span class="vx_label">Minimum Investment</span>
                  <div class="vx_stat">$<%= Number(bot.minInvestment).toLocaleString() %></div>
                </div>
                <div class="vx_stat_box">
                  <span class="vx_label">Maximum Investment</span>
                  <div class="vx_stat">$<%= Number(bot.maxInvestment).toLocaleString() %></div>
                </div>

                <div class="vx_expected_roi_box">
                  <span class="vx_label">Expected ROI</span>
                  <div class="vx_stat"><%= bot.expectedROI %></div>
                </div>
              </div>

              <div class="vx_divider"></div>

              <div class="vx_investment_amount_section">
                <label class="vx_amount_label">Investment Amount</label>
                <div class="vx_control">
                  <span style="color: #64748b; font-weight: 600;">$</span>
                  <input class="vx_input" id="vx_invest_amount" type="number" value="<%= bot.minInvestment %>" min="<%= bot.minInvestment %>" max="<%= bot.maxInvestment %>" />
                </div>
                <div class="vx_helper_text">Min: $<%= Number(bot.minInvestment).toLocaleString() %> / Max: $<%= Number(bot.maxInvestment).toLocaleString() %></div>
              </div>

              <div class="vx_reinvest_section">
                <div class="vx_reinvest_label">Auto-reinvest profits</div>
                <div class="vx_checkbox_group">
                  <input id="vx_reinvest" type="checkbox" checked class="vx_checkbox" />
                  <label for="vx_reinvest" style="color: #cbd5e1; font-size: 0.9rem; cursor: pointer;">Enable auto-reinvestment</label>
                </div>

                <div class="vx_reinvest_label">Reinvestment Percentage</div>
                <div class="vx_reinvest_pct_group">
                  <input class="vx_reinvest_pct_input" id="vx_reinvest_pct" type="number" value="50" min="0" max="100" />
                  <span class="vx_small">%</span>
                </div>
              </div>

              <button id="vx_start_invest" class="vx_btn_primary" style="width: 100%; margin-top: 1.5rem;">Start Investment</button>

              <div class="vx_risk_section">
                <div class="vx_risk_title">
                  <span>‚ö†Ô∏è</span>
                  Risk Warning
                </div>
                <div class="vx_risk_text">
                  Trading involves substantial risk and may result in loss of capital. Past performance does not guarantee future results.
                </div>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </main>
  </div>

  <script>
    (function(){
      document.getElementById('vx_start_invest').addEventListener('click', function(){
        const amount = Number(document.getElementById('vx_invest_amount').value) || Number(document.getElementById('vx_invest_amount').getAttribute('min'));
        if(!amount || amount < <%= bot.minInvestment %>) { alert('Please enter an amount of at least $' + <%= bot.minInvestment %>); return; }
        fetch('/user/join-plan', {
          method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ amount, planId: 'bot-<%= bot.id %>', planName: '<%= bot.name %>' })
        }).then(r=>r.json()).then(function(data){
          if(!data || !data.success){ if(data && data.redirect) return window.location.href = data.redirect; return alert(data && data.message ? data.message : 'Failed to start investment'); }
          alert('Investment started. Trading has started.');
          setTimeout(()=> window.location.reload(),800);
        }).catch(function(e){ console.error(e); alert('Network error'); });
      });
    })();
  </script>
</body>
</html>
